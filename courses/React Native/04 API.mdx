<Slides>

<ChapterHeading
  title="APIs React Native"
  imgSrc={require("../assets/backgrounds/cockpit.jpg").default.src}
/>

---

<SlideHeader slideTitle="UI - ScrollView" />

- https://reactnative.dev/docs/scrollview
- Composant container
- Permet de gérer un ensemble de composants enfants dépassant la hauteur ou
  largeur de l'écran
- Très utilisé sur chaque scène de l'application et pour les paginations,
  sliders...

---

<SlideHeader slideTitle="UI - FlatList" />
<HStack>

- https://reactnative.dev/docs/flatlist
- Affichage de données en liste
- Rendu intelligent, seul les éléments visibles sont rendus
- Contrôle via deux props
  - **data** : tableau de données
  - **renderItem** : callback avec en paramètre les données du row et en sortie
    la vue

<Image src={require("./assets/simulator-listview.png").default.src} width="35%" />
</HStack>

---

<SlideHeader slideTitle="UI - Image" />
<HStack>

- https://reactnative.dev/docs/image
- Affichage d'image locale ou distante
- Cache automatique
- Taille à préciser (jamais de rendu "auto" pour éviter bug de layout au
  chargement)

<Image src={require("./assets/simulator-images.png").default.src} width="35%" />
</HStack>

---

<SlideHeader slideTitle="UI - Textes et formulaires" />
<HStack>

- Composant [Text](https://reactnative.dev/docs/text)
- Composant [TextInput](https://reactnative.dev/docs/textinputl)
- Composant [Switch](https://reactnative.dev/docs/switch)
- [Datepicker](https://github.com/react-native-datetimepicker/datetimepicker)
  (module externe)

<Image src={require("./assets/simulator-forms.gif").default.src} width="35%" />
</HStack>

---

<SlideHeader slideTitle="UI - Indicateur d'activité" />
<HStack>

- https://reactnative.dev/docs/activityindicator
- Affichage d'un spinner
- À utiliser à chaque fois que l'utilisateur doit attendre un chargement
- Couleur et taille personnalisables

<Image src={require("./assets/simulator-activityindicator.png").default.src} width="35%" />
</HStack>

---

<SlideHeader slideTitle="UI - Modal" />
<HStack>

- https://reactnative.dev/docs/modal
- Pratique pour certaines actions en dehors de la navigation (validation,
  paramétrages, login, …)

<Image src={require("./assets/simulator-modal.png").default.src} width="35%" />
</HStack>

---

<SlideHeader slideTitle="UI - Refresh control" />
<HStack>

- https://reactnative.dev/docs/refreshcontrol
- Comportement "Pull to refresh", à rajouter sur une scrollView
- Rendu différent selon la plateforme (material design pour android)

<Image src={require("./assets/simulator-refreshcontrol.png").default.src} width="35%" />
</HStack>

---

<SlideHeader slideTitle="UI - Pressable components" />
<HStack>

- **Composants rajoutant le comportement "Pressable" :**
  - TouchableHighlight
  - TouchableOpacity
  - TouchableWithoutFeedback
  - TouchableNativeFeedback (android)
  - Pressable

<Image src={require("./assets/simulator-touchable.png").default.src} width="35%" />
</HStack>

---

<SlideHeader slideTitle="UI - WebView" />
<HStack>

- Vue navigateur web
- Contenu local ou distant
- Controle de l'historique avec goBack, goForward, reload, stopLoading

<Image src={require("./assets/simulator-webview.png").default.src} width="35%" />
</HStack>

---

<SlideHeader slideTitle="Et bien d'autres..." />
<HStack>

- TabBar
- SegmentedControl
- StatusBar
- DrawerLayoutAndroid
- ViewPagerAndroid
- Map
  ([react-native-maps](https://github.com/lelandrichardson/react-native-maps))
- ...

<Image src={require("./assets/simulator-mapview.png").default.src} width="35%" />
</HStack>

---

<SlideHeader slideTitle="API - Geolocation" />

- Module
  [react-native-geolocation](https://github.com/react-native-geolocation/react-native-geolocation)
- Récupérer la position de l'utilisateur
- Implémentation de la web API Geolocation
- Methodes getCurrentPosition, watchPosition, stopObserving
- Pas de Geocoding (mais dispo via un module
  [react-native-geocoder](https://github.com/devfd/react-native-geocoder))

---

```jsx
// Get first position
Geolocation.getCurrentPosition(
  (position) => {
    const initialPosition = JSON.stringify(position);
    this.setState({initialPosition});
  },
  (error) => alert(error.message),
  {enableHighAccuracy: true, timeout: 20000, maximumAge: 1000}
);

// Listen for update
let listenerId = Geolocation.watchPosition((position) => {
  const lastPosition = JSON.stringify(position);
  this.setState({lastPosition});
});

...

// When position update is no longer needed, clear the listener
navigator.clearWatch(listenerId);
```

---

<SlideHeader slideTitle="API - Alert" />
<HStack>

- Possibilité d'ajouter plusieurs boutons et du texte
- Alerte statique
- AlertIOS pour ajouter un ou plusieurs champs texte

<Image src={require("./assets/simulator-alert.png").default.src} width="35%" />
</HStack>

---

<SlideHeader slideTitle="API - CameraRoll" />
<HStack>

- [react-native-cameraroll](https://github.com/react-native-cameraroll/react-native-cameraroll)
- Accès aux medias vidéos et photos
- Méthodes saveToCameraRoll et getPhotos
- Pas de possibilité pour prendre des photos, mais module contribué disponible :
  [react-native-camera](https://github.com/react-native-camera/react-native-camera)

<Image src={require("./assets/simulator-cameraroll.png").default.src} width="35%" />
</HStack>

---

<SlideHeader slideTitle="API - Linking" />

- Pour intéragir avec d'autres applications facilement
- **openURL** : ouvre un site web, lance un appel, une autre application...
- **addEventListener, removeEventListener** : écouter quand l'application est
  lancée via un lien

```jsx
import { Linking } from "react-native";

const companyAccount = "twitter://user?screen_name=premieroctet";

if (Linking.canOpenURL(companyAccount)) {
  Linking.openUrl(companyAccount);
}
```

---

<SlideHeader slideTitle="Layout styles et positionnement" />
<HStack>

- Implémentation de flexbox (flexDirection, alignItems, justifyContent) comme en
  CSS
- Le style d'un élément est un objet JS : nom des propriétés similaires au CSS
  mais en lowerCamelCase.

<Image src={require("./assets/simulator-flexbox.png").default.src} width="35%" />
</HStack>

---

<SlideHeader slideTitle="Flexbox" />

- **flexDirection**
  - Détermine l'axe de layout
  - _row_ ou _column_ (défaut)
- **justifyContent**
  - Détermine comment les enfants vont se positionner sur l'axe choisi
  - _flex-start, center, flex-end, space-around, ou space-between_
- **alignItems**
  - Détermine comment les enfants vont se positionner sur l'axe secondaire (si
    row alors l'axe est column)
  - _flex-start, center, flex-end, ou stretch_

**La combinaison de ces 3 propriétés peut résoudre la plupart de positionnements
(et fonctionnent sur le web) !**

---

<SlideHeader slideTitle="Exemple Flexbox" />

```jsx
{
[...]

export default () => (
  <View style={styles.container}>
      <View style={styles.halfHeight} />
      <View style={styles.quarterHeight} />
      <View style={[styles.quarterHeight, {backgroundColor: 'green'}]} />
  </View>
)

const styles = StyleSheet.create({
    container: {
        flex: 1,
        flexDirection: 'column'
    },
    halfHeight: {
        flex: .5,
      	backgroundColor: 'red'
    },
    quarterHeight: {
        flex: .25,
      	backgroundColor: 'blue'
    }
});
```

---

<SlideHeader slideTitle="Animation avec Animated" />

<Flex>

- Librairie d'animation exécuté sur le thread JS
- Attention aux performances
- Composable, avec interpolations, parallélisme...
- Mapping possible d'une interaction utilisateur avec une animation
  (Animated.event)

```jsx
const FadeInView = (props) => {
  // Initial value for opacity: 0
  const fadeAnim = useRef(new Animated.Value(0)).current;

  React.useEffect(() => {
    Animated.timing(fadeAnim, {
      toValue: 1,
      duration: 10000,
    }).start();
  }, [fadeAnim]);

  return (
    <Animated.View
      style={{
        ...props.style,
        // Bind opacity to animated value
        opacity: fadeAnim,
      }}
    >
      {props.children}
    </Animated.View>
  );
};
```

</Flex>

</Slides>
