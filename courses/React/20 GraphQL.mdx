import { Image } from "@chakra-ui/image";
import ChapterHeading from "@/components/mdx/ChapterHeading";
import { MdCheckCircle, MdCancel } from "react-icons/md";

<Slides title="GraphQL" course="Formation React">

<ChapterHeading title="GraphQL" />

---

<SlideHeader slideTitle="GraphQL" />

#### Graphql - https://graphql.org

<Image
  src={require("./assets/graphql.png").default.src}
  width="90%"
  m="0 auto"
/>

---

<SlideHeader slideTitle="GraphQL" />

- API typée avec un schéma
- Indépendant de la base de donnée
- On récupère l'information via des "Query"
- On met à jour via des "Mutation"

---

<SlideHeader slideTitle="GraphQL : schéma" />

#### Schéma

```graphql
type Query {
  me: User
}

type User {
  id: ID
  name: String
}
```

---

<SlideHeader slideTitle="GraphQL : resolvers" />

#### Resolvers

```js
function Query_me(request) {
  return request.auth.user;
}

function User_name(user) {
  return user.getName();
}
```

---

<SlideHeader slideTitle="GraphQL : resolvers" />

#### Requêtes

```graphql
{
  me {
    name
  }
}
```

#### Résultat

```json
{
  "me": {
    "name": "Luke Skywalker"
  }
}
```

---

<SlideHeader slideTitle="GraphQL Playground" />

<a href="https://countries.trevorblades.com">
  <Image src={require("./assets/graphql-playground.png").default.src} />
</a>

---

<SlideHeader slideTitle="GraphQL" />

- On ne récupère que les données nécessaires !
- S'interface facilement avec React

---

<SlideHeader slideTitle="GraphQL avec React" />

<Box fontSize="0.9em">

```jsx
import gql from "graphql-tag";
import { Query } from "react-apollo";

const GET_COUNTRIES = gql`
  {
    countries {
      code
      name
      emoji
    }
  }
`;

const Countries = ({ onCountrySelected }) => (
  <Query query={GET_COUNTRIES}>
    {({ loading, error, data }) => {
      if (loading) return "Loading...";
      if (error) return error.message;

      return (
        <select name="country" onChange={onCountrySelected}>
          {data.countries.map((country) => (
            <option key={country.code} value={country.code}>
              {country.emoji} {country.name}
            </option>
          ))}
        </select>
      );
    }}
  </Query>
);
```

</Box>

</Slides>
