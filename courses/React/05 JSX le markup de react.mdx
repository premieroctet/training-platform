import { Image } from "@chakra-ui/image";
import ChapterHeading from "@/components/mdx/ChapterHeading";
import { MdCheckCircle, MdCancel } from "react-icons/md";

<Slides title="JSX: le markup de React" course="Formation React">

<ChapterHeading
  title="Le markup de React : JSX"
  imgSrc={require("../assets/backgrounds/history.jpg").default.src}
/>

---

<SlideHeader slideTitle="Le markup de React : JSX" />

##### ‚ú® <b>Introducing : JSX</b>

- Un composant ne **retourne pas directement** du HTML mais du **JSX**
- C'est une extension de la syntaxe JS
- Permet d'√©crire des syntaxes plus complexes que du HTML (conditions,
  boucles...)
- Permet √† React d'appliquer son algorithme de **r√©conciliation** ‚ö°Ô∏è

---

<SlideHeader slideTitle="Le markup de React : JSX" />

#### Inclure des expressions dans du JSX

- Il faut encapsuler dans des accolades :

```jsx
function formatName(user) {
  return `${user.firstName} ${user.lastName}`;
}

const user = { firstName: "Tom", lastName: "Jerry", avatarUrl: "133244.png" };
const element = <h1>Hello, {formatName(user)} !</h1>;

ReactDOM.render(element, document.getElementById("app"));
```

---

<SlideHeader slideTitle="Le markup de React : JSX" />

#### JSX : choses √† savoir

- L'attribut "class" n'existe pas, il faut utiliser **className**
  ([liste des diff√©rences](https://reactjs.org/docs/dom-elements.html))
- L'attribut style attend un **objet JavaScript**
- Pour afficher conditionnellement une balise on peut utiliser l'op√©rateur
  **&&**

```jsx
const displayBackButton = false;
const imagesUrls = ["1.png", "2.png"];
const carousel = (
  <div className="carousel" style={{ backgroundColor: "#7fff00" }}>
    {imagesUrls.map((url) => (
      <Image src={url} />
    ))}
    {displayBackButton && <button>Back</button>}
  </div>
);
```

---

<SlideHeader slideTitle="Le markup de React : JSX" />

#### JSX : choses √† savoir

- Il faut toujours fermer les balises (comme le XML chaque tag doit √™tre ferm√©)
- On peut utiliser les fragments React afin de ne pas ajouter de balise HTML
  dans le DOM

```jsx
const App = (
  <>
    <h1>Hello</h1>
    <br />
    <hr />
    <section>My project</section>
  </>
);
```

---

<SlideHeader slideTitle="Le markup de React : JSX" />

#### üíÖ JSX : en coulisse

- Voici comment Babel compile du JSX
  ([cf. babeljs.io/repl](https://babeljs.io/repl/#?babili=false&browsers=&build=&builtIns=false&spec=false&loose=false&code_lz=MYGwhgzhAEASCmIQHtoG8BQ0BO8B2AJvNgBQCU6W0O8ALgK7Z7QA8BAlgG4B8CSyLAPQceWAL4YJQA&debug=false&forceAllTransforms=false&shippedProposals=false&circleciRepo=&evaluate=false&fileSize=false&timeTravel=false&sourceType=module&lineWrap=true&presets=react&prettier=false&targets=&version=6.26.0&envVersion=))
  :

```jsx
const element = <h1 className="greeting">Hello, world!</h1>;

const element = React.createElement(
  "h1",
  { className: "greeting" },
  "Hello, world!"
);
```

---

<SlideHeader slideTitle="Le markup de React : JSX" />

#### De l'√©l√©ment vers le composant React

- Ceci est un √©l√©ment React le plus simple possible :

```jsx
const element = <h1 className="greeting">Hello, world!</h1>;
const element2 = <div>{element}</div>;
```

- React apporte la notion de **composant** permettant d'ajouter **des propri√©t√©s
  et un √©tat** √† un √©l√©ment

---

<ChapterHeading title="Le markup de React : JSX" />

---

<SlideHeader slideTitle="Composant" />

#### Des composants React

- Se faire une repr√©sentation visuelle des composants d'une app est naturel¬†:

<Image src={require("./assets/jolichat.png").default.src} />

---

<SlideHeader slideTitle="Composant" />

##### **Un composant :** qu'est ce que c'est ? ü§î

- Ils repr√©sentent **des briques** de votre application
- Ils peuvent √™tre **r√©utilisables / partageables**
- Il y a **deux types** de composants :

  - Composant **fonctionnel**
  - Composant ** de classe**

---

<SlideHeader slideTitle="Les composants React" />

#### Composant fonctionnel

- C'est une simple fonction qui prend en argument des propri√©t√©s (appel√©es
  props)
- Il peut-√™tre **stateless** (le r√©sultat d√©pend **uniquement** des props
  pass√©es) ou **statefull** (avec les hooks)
- Il retourne du JSX (le "html" donc)

```jsx
function UserAvatar(props) {
  return (
    <div>
      <Image src={props.avatarUrl} /> <span>{props.username}</span>
    </div>
  );
}

ReactDOM.render(
  // En coulisse UserAvatar({avatarUrl: "user.png", username: "Tom"})
  <UserAvatar avatarUrl={"user.png"} username={"Tom"} />,
  document.getElementById("app")
);
```

---

<SlideHeader slideTitle="Les composants React" />

#### Composant fonctionnel

- Avec la **syntaxe ES6** (arrow functions et destructuring) :

```jsx
const UserAvatar = ({ avatarUrl, username }) => {
  return (
    <div>
      <Image src={avatarUrl} />
      <span>{username}</span>
    </div>
  );
};

ReactDOM.render(
  <UserAvatar avatarUrl={"user.png"} username={"Tom"} />,
  document.getElementById("app")
);
```

---

<SlideHeader slideTitle="Les composants React" />

#### ‚òùÔ∏è On peut imbriquer des composants :

```jsx
const Profile = (props) => <h1>Hello, {props.name}</h1>;

function App() {
  return (
    <div>
      <Profile name="Tom" />
      <Profile name="Jane" />
      <Profile name="Tim" />
    </div>
  );
}

ReactDOM.render(<App />, document.getElementById("root"));
```

---

<SlideHeader slideTitle="Les composants React" />

#### Fonction au sein d'un composant fonctionnel

```jsx
const Hello = (props) => {
  const { name, age } = props;
  const bornYear = () => {
    const yearNow = new Date().getFullYear();
    return yearNow - age;
  };

  return (
    <div>
      <p>
        Hello {name}, you are {age} years old
      </p>
      <p>So you were probably born in {bornYear()}</p>
    </div>
  );
};
```

---

<SlideHeader slideTitle="Mise en pratique : Composants fonctionnels" />

##### üìêü§ì <b>Mise en pratique :</b> Composants fonctionnels

<Image src={require("./assets/jolichat.png").default.src} />

---

<SlideHeader slideTitle="Mise en pratique : Composants fonctionnels" />

##### üìêü§ì <b>Mise en pratique :</b> Composants fonctionnels

- Cr√©ez la structure d'un chat avec des composants fonctionnels :

  - Un composant **Chat** parent
  - Un composant **MessageList** disposant de plusieurs **MessageItem**
  - Un composant **MessageBar**

- Cr√©ez un composant par fichier JS
- Mettez vos composants dans un dossier "components"

---

<SlideHeader slideTitle="Les composants React" />

#### ‚ú® Composant de classe

- C'est un composant qui √©tend la classe
  [Component de React](https://reactjs.org/docs/react-component.html)
- Il est constitu√© de :

  - Des **propri√©t√©s** (props)
  - Un **√©tat** (state) facultatif
  - Des **√©v√©nements** (lifecycle events)
  - Une **vue** (JSX)

---

<SlideHeader slideTitle="Les composants React" />

#### ‚ú® Composant de classe

- Il doit impl√©menter au minimum **la m√©thode render()** :

```jsx
import React, { Component } from 'react';

class UserAvatar extends Component {
  render() {
    return <div>
      <Image src={this.props.avatarUrl} />
      <span>{this.props.username}</span>
    </div>:
  }
}

ReactDOM.render(
  <UserAvatar avatarUrl={"user.png"} username={"Tom"} />,
  document.getElementById("app")
);
```

---

<SlideHeader slideTitle="Les composants React" />

#### ‚òùÔ∏è Pour r√©sumer

- Il existe **deux types de composant** :

  - **Fonctionnel**
  - **De classe** (React ES6 class component)

- Il faut privil√©gier au possible **les composants fonctionnels** (plus simples,
  moins verbeux et compatibles avec les hooks)

---

<SlideHeader slideTitle="Les composants React" />

#### üíÖ Nommage des composants

- Un fichier JS contient **un seul composant**
- On nomme toujours le fichier par le nom du composant **en upper camel case** :

<List paddingLeft="lg">
  <ListItem>
    <ListIcon as={MdCheckCircle} color="green.400" />
    UserAvatar.js
  </ListItem>
  <ListItem>
    <ListIcon as={MdCancel} color="red.400" />
    userAvatar.js
  </ListItem>
  <ListItem>
    <ListIcon as={MdCancel} color="red.400" />
    user-avatar.js
  </ListItem>
</List>

---

<SlideHeader slideTitle="Les composants React" />

#### üíÖ Nommage des composants

```jsx
const footer = () => {
  return <div>Copyright 2019</div>;
};

// Le composant footer sera rendu comme une balise HTML et non pas
// comme un composant React
const App = () => {
  return (
    <div>
      <h1>My Project</h1>
      <footer />
    </div>
  );
};
```

</Slides>
