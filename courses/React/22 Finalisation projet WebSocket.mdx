import { Image } from "@chakra-ui/image";
import ChapterHeading from "@/components/mdx/ChapterHeading";
import { MdCheckCircle, MdCancel } from "react-icons/md";

<Slides title="Finalisation projet : temps r√©el avec WebSocket" course="Formation React">

<SlideHeader slideTitle="Finalisation projet : temps r√©el avec WebSocket" />

#### Serveur node

<Box fontSize="0.8em">

```jsx
const WebSocket = require("ws");

const wss = new WebSocket.Server({ port: 8080 });
console.log("Starting websocket server");

// Memory database
const actions = [];

wss.on("connection", function connection(ws) {
  console.log(`new connection, ${wss.clients.size} clients`);

  // Send saved actions to new client
  actions.forEach((action) => {
    ws.send(action);
  });

  ws.on("message", function incoming(data) {
    console.log("new message", JSON.stringify(data));
    // Save action
    actions.push(data);

    // Broadcast to all clients
    wss.clients.forEach(function each(client) {
      if (client !== ws && client.readyState === WebSocket.OPEN) {
        client.send(data);
      }
    });
  });
});
```

</Box>

---

<SlideHeader slideTitle="Finalisation projet : temps r√©el avec WebSocket" />

##### üìêü§ì <b>Finalisation projet</b> : temps r√©el avec WebSocket

- Utiliser un serveur node avec WebSocket
- Ce qu'il faut faire :
  - Cr√©er un service pour acc√©der √† la connexion WebSocket
    ./service/websocket.js
  - Ce service se connecte au serveur websocket et dispatch une action lorsqu'il
    re√ßoit un nouveau message
  - Les actions sont partag√©es sur le r√©seau, notre tchat est en ligne !

</Slides>
