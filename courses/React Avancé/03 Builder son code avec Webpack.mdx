import { Image } from "@chakra-ui/image";
import ChapterHeading from "@/components/mdx/ChapterHeading";
import { MdCheckCircle, MdCancel } from "react-icons/md";

<Slides title="introduction" course="Formation React">

<ChapterHeading title="Builder son code avec Webpack" />

---

<SlideHeader slideTitle="Bundling" />

##### <b>Le bundling :</b> qu'est ce que c'est ? ğŸ¤”

- La multiplication du nombre de fichiers JavaScript dans une page web peut
  devenir un frein aux performances
- Un bundler est un outil qui regroupe du code et toutes ses dÃ©pendences en un
  seul fichier.
- Le temps de chargement est rÃ©duit en mÃªme temps que le nombre de requÃªtes pour
  des fichiers JavaScript.

---

<SlideHeader slideTitle="Builder son code avec Webpack" />

#### Exemples de bundlers populaires :

- Webpack https://webpack.js.org/
- Rollup https://rollupjs.org/
- Browserify https://browserify.org/

---

<SlideHeader slideTitle="Builder son code avec Webpack" />

<Image src={require("./assets/logo-webpack.png").default.src} width="50%" />

##### Utiliser <b>Webpack</b> comme outil de build ğŸš€

- https://webpack.js.org/
- Organise l'application JS en bundles, mais Ã©galement les autres ressources
  nÃ©cessaires (css, imagesâ€¦)
- Offre un serveur de dÃ©veloppement permettant le hot reload ğŸ”¥

---

<SlideHeader slideTitle="Builder son code avec Webpack" />

#### ğŸ“¦ CrÃ©er un simple bundle

- On ajoute Webpack localement en dÃ©pendances (dev)
- On peut alors crÃ©er un bundle de notre code (src/ vers build/)

```
yarn add --dev webpack
./node_modules/.bin/webpack src/index.js
```

---

<SlideHeader slideTitle="Builder son code avec Webpack" />

#### ğŸ“¦ CrÃ©er un simple bundle

- Comme pour Babel, on utilise le champ "**scripts**" du fichier
  **package.json** ğŸ˜

```json
{
  "scripts": {
    "webpack": "webpack src/index.js"
  },
  "devDependencies": {
    "webpack": "^4.5.1",
    "webpack-cli": "^3.1.2"
  }
}
```

---

<SlideHeader slideTitle="Premier build : mise en pratique" />

##### ğŸ“> <b>Mise en pratique</b> - Premier build

- Ajouter **React** Ã  votre projet avec Yarn
- Importer React dans votre fichier JS : `import React from 'react'`
- Builder votre fichier avec **Webpack** ğŸš€
- Ouvrez le fichier gÃ©nÃ©rÃ© par **Webpack**

---

<SlideHeader slideTitle="Builder son code avec Webpack" />

##### Gestion de la **config Webpack**

- Nous avons utilisÃ© Webpack avec la config par dÃ©faut
- Nous pouvons personnaliser la phase de build, en ajoutant le fichier
  **webpack.config.js**
- Nous commencons par dÃ©finir **le point d'entrÃ©e** et **le point de sortie** :

```js
var path = require("path");

module.exports = {
  entry: "./src/index.js",
  output: {
    filename: "bundle.js",
    path: path.resolve(__dirname, "build"),
  },
};
```

---

<SlideHeader slideTitle="Builder son code avec Webpack" />

##### Fonctionnement de **Webpack** âš™ï¸

<Image src={require("./assets/webpack-schema.png").default.src} margin="md" />

---

<SlideHeader slideTitle="Builder son code avec Webpack" />

##### Les loaders **Webpack** ğŸš©

- https://webpack.js.org/concepts/loaders/
- Les loaders dÃ©terminent quels traitements appliquer aux diffÃ©rentes ressources
  gÃ©rÃ©es par Webpack
- Il existe une multitude de loaders :
- [babel-loader (pour transpiler le js)](https://webpack.js.org/loaders/babel-loader/)
- [css-loader (pour build les css)](https://webpack.js.org/loaders/css-loader/)
- [file-loader (pour build les assets)](https://webpack.js.org/loaders/file-loader/)

---

<SlideHeader slideTitle="Builder son code avec Webpack" />

##### Les loaders **Webpack** ğŸš©

- On les renseigne dans le tableau **rules** de notre fichier de configuration :

```js
var path = require("path");

module.exports = {
  entry: "./src/index.js",
  output: {
    filename: "bundle.js",
    path: path.resolve(__dirname, "build"),
  },
  module: {
    rules: [{ test: /\.css$/, use: "css-loader" }],
  },
};
```

---

<SlideHeader slideTitle="Builder son code avec Webpack" />

##### Les plugins **Webpack** âœ¨

- Les **plugins** apportent de nouvelles fonctionnalitÃ©s Ã  Webpack comme -
  [webpack-bundle-analyzer](https://github.com/webpack-contrib/webpack-bundle-analyzer)
  qui permet de visualiser ses dÃ©pendances :

```js
var path = require("path");
const BundleAnalyzerPlugin =
  require("webpack-bundle-analyzer").BundleAnalyzerPlugin;

module.exports = {
  entry: "./src/index.js",
  output: {
    filename: "bundle.js",
    path: path.resolve(__dirname, "build"),
  },
  plugins: [new BundleAnalyzerPlugin()],
};
```

---

<SlideHeader slideTitle="Builder son code avec Webpack" />

##### Les modes **Webpack** ğŸš€

- Il existe deux modes: `production` et `developpement`

```js
// Via la config
module.exports = {
	// ...
	mode: 'production'
};

// Via le cli
webpack --mode=developpement
```

---

<SlideHeader slideTitle="Config Webpack : mise en pratique" />

##### ğŸ“> <b>Mise en pratique</b> - Config Webpack

<List fontSize="1em" textAlign="left" m="0.6em 0" padding="12px 0">
  <ListItem>
    Pour l'instant nous avons perdu la transpilation de <b>Babel</b>, nous
    allons donc utiliser le <b>loader Babel</b> pour les fichiers JS.
  </ListItem>
  <ListItem>
    <ListIcon as={MdCheckCircle} color="green.300" />
    Ajouter le <b>babel-loader</b> Ã  votre projet
  </ListItem>
  <ListItem>
    <ListIcon as={MdCheckCircle} color="green.300" />
    Activer le plugin <b>
      <a href="https://github.com/webpack-contrib/webpack-bundle-analyzer">
        webpack-bundle-analyzer
      </a>
    </b>
  </ListItem>
  <ListItem>
    <ListIcon as={MdCheckCircle} color="green.300" />
    VÃ©rifier que le fichier gÃ©nÃ©rÃ© ne contient plus de ES6
  </ListItem>
  <ListItem>
    <ListIcon as={MdCheckCircle} color="green.300" />
    Visualiser vos dÃ©pendances en mode production et dÃ©veloppement
  </ListItem>
</List>

</Slides>
